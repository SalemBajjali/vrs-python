#!/usr/bin/env python3

import redis
import yaml

from ga4gh.core import *
from ga4gh.vr import *
from ga4gh.vr._internal.models import _load_vr_models

from ga4gh.vr.extras.redisobjectstore import RedisObjectStore

import IPython


test_fns = {
    "models": "tests/validation/data/models.yaml",
    "functions": "tests/validation/data/functions.yaml"
    }
tests = {
    k: yaml.load(open(test_fns[k]), Loader=yaml.SafeLoader)
    for k in test_fns
    }


a0 = models.Allele(**tests["models"]["Allele"][0]["in"])
a0._id = ga4gh_identify(a0)

a1 = models.Allele(**tests["models"]["Allele"][1]["in"])
a1._id = ga4gh_identify(a1)


ros = RedisObjectStore(redis=redis.Redis(db=15), models=models)
ros.redis.flushdb()             # Danger!

ros[str(a0._id)] = a0
a0b = ros[str(a0._id)]


IPython.embed()

